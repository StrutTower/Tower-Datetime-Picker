!function(){"use strict";function e(e){return{restrict:"E",templateUrl:"twrDatetimePicker.html",transclude:!0,scope:{ngModel:"="},link:function(t,n,a){function r(){23===t.date.hour?t.date.hour=0:t.date.hour++}function d(){0===t.date.hour?t.date.hour=23:t.date.hour--}function i(){t.date.minute>=0&&t.date.minute<15?t.date.minute=15:t.date.minute>=15&&t.date.minute<30?t.date.minute=30:t.date.minute>=30&&t.date.minute<45?t.date.minute=45:t.date.minute>=45&&(t.date.hour=t.date.hour+1,t.date.minute=0)}function s(){t.date.minute>0&&t.date.minute<=15?t.date.minute=0:t.date.minute>15&&t.date.minute<=30?t.date.minute=15:t.date.minute>30&&t.date.minute<=45?t.date.minute=30:(0===t.date.minute||t.date.minute>45)&&(t.date.hour=t.date.hour-1,t.date.minute=45)}function c(){t.settings.currentView=t.settings.defaultView,l()}function l(){t.date.display||(t.date.display=new Date),v(),t.settings.isVisible||(t.settings.isVisible=!0)}function o(){t.settings.isVisible=!1}function u(e){t.settings.isVisible&&(o(),t.$digest())}function g(e){e.stopPropagation()}function h(){var e=t.date.display;"month"===t.settings.currentView?t.date.display=new Date(e.getFullYear(),e.getMonth()-1,e.getDate()):"year"===t.settings.currentView&&(t.date.display=new Date(e.getFullYear()-1,e.getMonth(),e.getDate())),v()}function w(){var e=t.date.display;"month"===t.settings.currentView?t.date.display=new Date(e.getFullYear(),e.getMonth()+1,e.getDate()):"year"===t.settings.currentView&&(t.date.display=new Date(e.getFullYear()+1,e.getMonth(),e.getDate())),v()}function m(){"time"===t.settings.currentView&&t.settings.datePicker?(t.settings.currentView="month",v()):"month"===t.settings.currentView&&(t.settings.currentView="year",v())}function p(e){var n=t.date.display.getFullYear();t.date.display=new Date(n,e,1),t.settings.currentView="month",v()}function y(e){if(t.date.selected){var n=t.date.selected;t.date.selected=new Date(e.getFullYear(),e.getMonth(),e.getDate(),n.getHours(),n.getMinutes())}else t.date.selected=new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0);t.date.display=t.date.selected,M(),t.settings.timePicker?t.settings.currentView="time":t.settings.autoClose&&o(),v()}function v(){t.date.display||(t.date.display=new Date);var e=t.date.display;"year"===t.settings.currentView?b(e):"month"===t.settings.currentView?f(e):"time"===t.settings.currentView&&D(e)}function D(e){if(t.settings.timePicker){if(!t.date.selected){var n=new Date;t.date.selected=new Date(n.getFullYear(),n.getMonth(),n.getDate(),12,0)}t.date.hour=t.date.selected.getHours(),t.date.minute=t.date.selected.getMinutes()}}function f(e){t.weeks=[];var n,a,r=[],d=new Date(e.getFullYear(),e.getMonth(),1),i=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),s=d.getDay(),c=1;if(s>0)for(a=new Date(d),a.setDate(d.getDate()-s),n=0;s>n;n++)c>7&&(c=1,t.weeks.push(r),r=[]),r.push({date:new Date(a),day:a.getDate(),otherMonth:!0,now:F(a,new Date),selected:F(a,t.date.selected)}),c++,a.setDate(a.getDate()+1);for(a=d,n=0;i>n;n++)c>7&&(c=1,t.weeks.push(r),r=[]),r.push({date:new Date(a),day:a.getDate(),otherMonth:!1,now:F(a,new Date),selected:F(a,t.date.selected)}),c++,a.setDate(a.getDate()+1);var l=new Date(a);if(l.setDate(a.getDate()-1),l.getDay()<7)for(n=l.getDay();6>n;n++)r.push({date:new Date(a),day:a.getDate(),otherMonth:!0,now:F(a,new Date),selected:F(a,t.date.selected)}),a.setDate(a.getDate()+1);t.weeks.push(r)}function b(e){var n=0;t.months=[];var a=[],r=new Date;angular.forEach(t.monthNames,function(d,i){var s=!1;r.getFullYear()===e.getFullYear()&&r.getMonth()===i&&(s=!0);var c=!1;t.date.selected&&t.date.selected.getFullYear()===e.getFullYear()&&t.date.selected.getMonth()===i&&(c=!0);var l={name:d,number:i,year:e.getFullYear(),now:s,selected:c};a.push(l),n++,n>3&&(t.months.push(a),a=[],n=0)})}function k(){var e=a.dateOnly;null!=e&&(t.settings.timePicker=!1);var n=a.timeOnly;if(null!=n&&(t.settings.datePicker=!1),!t.settings.timePicker&&!t.settings.datePicker)throw"tower-datetime-picker: The date picker and time picker cannot both be deactivated.";t.settings.timePicker&&!t.settings.datePicker&&(t.settings.defaultView="time");var r=a.showClearButton;null!=r&&(t.settings.showClearButton=!0);var d=a.dateAutoclose;null!=d&&(t.settings.autoClose=!0)}function M(){t.ngModel=t.date.selected}function V(){t.date.selected=void 0,M(),o()}function F(e,t){return!(!e||!t||e.getFullYear()!==t.getFullYear()||e.getMonth()!==t.getMonth()||e.getDate()!==t.getDate())}t.weeks=[],t.date={},t.monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t.days=["Su","Mo","Tu","We","Th","Fr","Sa"],t.settings={isVisible:!1,isHovering:!1,defaultView:"month",currentView:"",datePicker:!0,timePicker:!0,showClearButton:!1,autoClose:!1},e.on("click",u),n.on("click",g),k(),t.ngModel&&(t.date.selected=new Date(t.ngModel),t.date.display=new Date(t.ngModel)),t.transcludeClicked=c,t.previous=h,t.next=w,t.selectDate=y,t.selectMonth=p,t.previousView=m,t.clearModel=V,t.nextHour=r,t.previousHour=d,t.nextMinute=i,t.previousMinute=s,t.$watch("date.hour",function(e){var n=t.date.selected;e>=0&&24>e&&n&&(t.date.minute||(t.date.minute=0,t.date.displayMinute="00"),t.date.selected=new Date(n.getFullYear(),n.getMonth(),n.getDate(),t.date.hour,t.date.minute),M())}),t.$watch("date.minute",function(e){var n=t.date.selected;if(e>=0&&60>e&&n){t.date.hour||(t.date.hour=0),t.date.selected=new Date(n.getFullYear(),n.getMonth(),n.getDate(),t.date.hour,t.date.minute);var a=t.date.minute.toString();1===a.length&&(a="0"+a),t.date.displayMinute=a,M()}})}}}angular.module("twrDatetimePicker",[]).directive("twrDatetime",e),e.$inject=["$document"],angular.module("twrDatetimePicker").run(["$templateCache",function(e){e.put("twrDatetimePicker.html",'<div class="twr-date-picker-template" data-ng-class="{\'hide-picker\': !settings.isVisible}">\r\n    <data-ng-transclude data-ng-click="transcludeClicked()"></data-ng-transclude>\r\n\r\n    <div class="twr-date-picker-container">\r\n\r\n        <table class="twr-date-picker-header">\r\n            <tbody>\r\n                <tr>\r\n                    <td class="twr-date-picker-header-button-left">\r\n                        <div data-ng-hide="settings.currentView == \'time\'">\r\n                            <a href="" class="chevrons" data-ng-click="previous()">\r\n                                <b class="twr-chevron-left"></b>\r\n                            </a>\r\n                        </div>\r\n                    </td>\r\n                    <td class="twr-date-picker-title">\r\n                        <div data-ng-click="previousView()"\r\n                             data-ng-show="settings.datePicker"\r\n                             data-ng-switch="settings.currentView">\r\n                            <span data-ng-switch-when="time" data-ng-bind="date.display | date: \'M/d/yyyy\'">\r\n                            </span>\r\n                            <span data-ng-switch-when="month" data-ng-bind="date.display | date: \'MMMM yyyy\'">\r\n                            </span>\r\n                            <span data-ng-switch-when="year" data-ng-bind="date.display | date: \'yyyy\'">\r\n                            </span>\r\n                        </div>\r\n                    </td>\r\n                    <td class="twr-date-picker-header-button-right">\r\n                        <div data-ng-hide="settings.currentView == \'time\'">\r\n                            <a href="" class="chevrons" data-ng-click="next()">\r\n                                <b class="twr-chevron-right"></b>\r\n                            </a>\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n\r\n        <div class="twr-date-picker-body" data-ng-switch data-on="settings.currentView">\r\n\r\n            <div class="twr-time-view" data-ng-switch-when="time">\r\n                <table>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>\r\n                                <a href="" class="chevrons" data-ng-click="nextHour()">\r\n                                    <b class="twr-chevron-up"></b>\r\n                                </a>\r\n                            </td>\r\n                            <td class="time-spacer-col"></td>\r\n                            <td>\r\n                                <a href="" class="chevrons" data-ng-click="nextMinute()">\r\n                                    <b class="twr-chevron-up"></b>\r\n                                </a>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>\r\n                                <input type="number" max="23" data-ng-model="date.hour" data-ng-change="hourChanged()" class="form-control" />\r\n                            </td>\r\n                            <td class="time-spacer-col">:</td>\r\n                            <td>\r\n                                <input type="text" minlength="1" maxlength="2"\r\n                                       data-ng-model="date.displayMinute" \r\n                                       data-ng-change="minuteChanged()"\r\n                                       pattern="([0-9]|[0-5][0-9])"\r\n                                       class="form-control" />\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>\r\n                                <a href="" class="chevrons" data-ng-click="previousHour()">\r\n                                    <b class="twr-chevron-down"></b>\r\n                                </a>\r\n                            </td>\r\n                            <td class="time-spacer-col"></td>\r\n                            <td>\r\n                                <a href="" class="chevrons" data-ng-click="previousMinute()">\r\n                                    <b class="twr-chevron-down"></b>\r\n                                </a>\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n            <div class="twr-view-month" data-ng-switch-when="month">\r\n                <table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th data-ng-repeat="day in days" data-ng-bind="day"></th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr data-ng-repeat="week in weeks">\r\n                            <td data-ng-repeat="day in week"\r\n                                data-ng-class="{\'other-month\': day.otherMonth, \'now\': day.now, \'selected\': day.selected}"\r\n                                data-ng-click="selectDate(day.date)"\r\n                                data-ng-bind="day.day">\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n            <div class="twr-view-year" data-ng-switch-when="year">\r\n                <table>\r\n                    <tbody>\r\n                        <tr data-ng-repeat="monthGroup in months">\r\n                            <td data-ng-repeat="month in monthGroup"\r\n                                data-ng-class="{\'now\': month.now, \'selected\': month.selected}"\r\n                                data-ng-click="selectMonth(month.number)"\r\n                                data-ng-bind="month.name">\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <div class="twr-date-picker-footer">\r\n            <div class="twr-date-picker-button-panel" data-ng-show="settings.showClearButton">\r\n                <button type="button" data-ng-click="clearModel()">Clear Date/Time</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>')}])}();